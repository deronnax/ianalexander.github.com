<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Summary of the Amazon Web Services AMA</title>
        <meta name="description" content="">
        <meta name="author" content="Ian Alexander">
		<link href="http://feeds.feedburner.com/ianalexandr" rel="alternate" title="Ian Alexander" type="application/atom+xml" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" href="/media/css/bootstrap.css">

        <style>
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>

        <link rel="stylesheet" href="/media/css/bootstrap-responsive.css">
        <link rel="stylesheet" href="/media/css/main.css">
        <link rel="stylesheet" href="/media/css/pygments.css">

        <script src="/media/js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
        <meta name="google-site-verification" content="BKR9TZ7BJUDYLzFZwFg6I5P-oOCnmYvetxlA474ab2Y" />
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <div class="container">
            <div class="row">
                <div class="span8 offset2">
                    <p id="navigation">
                        <a href="https://www.facebook.com/ian.m.alexander" onclick="clickme('facebook');">facebook</a> /
                        <a href="https://twitter.com/ianalexan" onclick="clickme('twitter');">twitter</a> /
                        <a href="https://www.linkedin.com/in/ianmalexander" onclick="clickme('linkedin');">linkedin</a> /
                        <a href="http://www.quora.com/Ian-Alexander-5/answers" onclick="clickme('quora');">quora</a> /
                        <a href="https://github.com/ianalexander" onclick="clickme('github');">github</a> /
                        <a href="http://instagram.com/ianalexan" onclick="clickme('instagram');">instagram</a>
                        </br>
                        <a href="/blog">blog</a> <!-- &mdash; -->
                    </p>
                </div>
            </div>
        </div>

        <div class="container">
                        <div class="row">
                <div class="span8 offset2">
                    <h2 class="post-title">Summary of the Amazon Web Services AMA</h2>
    <p class="post-info">
        posted by Ian on May 20, 2013
    </p>

    <p>Last week, a reddit user under the name &#8216;<span class="caps">AWSIAMA</span>&#8217; <a href="http://www.reddit.com/r/IAmA/comments/1e5o4p/iaman_exaws_engineer_ask_me_anything_about_the/">posted an <span class="caps">AMA</span></a> about being an Engineer at the <span class="caps">AWS</span> cloud. Like most Reddit AMAs, there is a lot of noise to get to the really good parts. This is a summary of the <span class="caps">AMA</span> highlighting the most interesting and useful pieces of&nbsp;information.</p>
<h2>Working at&nbsp;Amazon</h2>
<blockquote>
<p>Negative, their stock plan isn&#8217;t very great either. You don&#8217;t go to Amazon for the pay. You go for the free beer, literally. Also, there is a 10% discount on all things at Amazon.com up to the first $1000. So a maximum of $100 in savings. The companies core values include &#8220;frugality&#8221; and that&#8217;s just the word &#8220;cheap&#8221; wrapped up in a&nbsp;bow.</p>
<p>&#8230;</p>
<p>Amazon is a product of the past laying the groundwork for the future. One of my friends who was a <span class="caps">SDE</span> (Software Development Engineer) had the most mundane tasks ever. He actually quit as well and went to work somewhere for a little less money, but doing some far more rewarding&nbsp;work.</p>
<p>Putting Amazon <span class="caps">SDE</span> on your resume is quickly turning into the same thing as putting Google <span class="caps">SDE</span> on your resume. So, while you may feel it&#8217;s boring, the real reward will be the job opportunities in the&nbsp;future.</p>
</blockquote>
<h2><span class="dquo">&#8220;</span>The Cloud&#8221; and Marketing&nbsp;Hype</h2>
<blockquote>
<p>The cloud, it&#8217;s an &#8220;interesting&#8221; concept, because in a lot of ways it&#8217;s still just a <span class="caps">VPS</span>. Sure it has some redundant features, but the definition of cloud is fairly dynamic and bent to fit whatever a company wants to sell as a&nbsp;&#8220;cloud&#8221;.</p>
</blockquote>
<h2>The&nbsp;Competition</h2>
<blockquote>
<p>I believe that Microsoft Azure and <span class="caps">AWS</span> (as well as Google Compute Cloud, Rackspace and even places like Linode) are all on the same playing field to a point. If it was a venn diagram (remember 2nd grade now) there would be major overlap. The places outside the overlap is what differentiates all the individual&nbsp;companies.</p>
<p>I think that healthy competition will drive down pricing to fair levels as well as encourage upgrades and better levels of quality all around. As far as serious threat? Well, no, I don&#8217;t consider Azure a threat to <span class="caps">AWS</span>, but I consider Google a threat to <span class="caps">AWS</span>. Google&#8217;s cloud has been outperforming <span class="caps">AWS</span> since very private beta and performance means a lot in the&nbsp;cloud.</p>
<p>Anyone who thinks there is a &#8220;cloud war&#8221; currently and <span class="caps">AWS</span> is seeing any type of real challenge is just fooling themselves. Nobody can compete currently with the size of <span class="caps">AWS</span>, they were the first in and will be the last&nbsp;out.</p>
<p>Google however will make it rain a bit, I&#8217;ve been using their cloud platform a little bit lately and I have to say. It&#8217;s hella&nbsp;impressive.</p>
</blockquote>
<h2><span class="caps">EBS</span>, <span class="caps">EBS</span>-Optimized <span class="amp">&amp;</span> Provisioned&nbsp;<span class="caps">IOPS</span></h2>
<blockquote>
<p><span class="caps">EBS</span> v. EBSo is honestly the easiest thing to explain why you need it. <span class="caps">EBS</span> and network traffic flows over the same <span class="caps">NIC</span>. EBSo adds a <span class="caps">QOS</span> marker to the packets. That simple. Anyone you talk to with some networking background will explain to you that by doing that, you&#8217;re going to significantly smooth out your <span class="caps">EBS</span> experience under heavy load&nbsp;instantly.</p>
<p>The ratio is simply marketing, it&#8217;s the internal break point. If you&#8217;re using <span class="caps">10GB</span> and rushing 30k <span class="caps">IOPS</span> over it, they&#8217;re not actually breaking even on the disk since you&#8217;re over utilizing the network bandwidth. The 10:1 ratio helps keep the whole system in that happy green zone where there is a nice profit margin and good&nbsp;performance.</p>
<p>Provisioned <span class="caps">IOPS</span> are typically best to move to <span class="caps">AFTER</span> you learn what your disk io is going to look like. Profile your <span class="caps">EBS</span> volumes, and if you use on average 318 <span class="caps">IOPS</span> throughout the month, then allocate <span class="caps">280IOP</span> disks, if you calculate out the <span class="caps">IOPS</span> cost on non <span class="caps">PIOPS</span> disks to <span class="caps">PIOPS</span> cost, you&#8217;ll&nbsp;save.</p>
<p>Consider <span class="caps">PIOPS</span> more of reservation and then it&#8217;s best paired with EBSo to ensure you can get quality <span class="caps">IO</span> at all&nbsp;times.</p>
</blockquote>
<h2><span class="dquo">&#8220;</span>Dirty Secret&#8221; of&nbsp;<span class="caps">RDS</span></h2>
<blockquote>
<p>So, here&#8217;s a <span class="caps">BIG</span> secret to <span class="caps">RDS</span>. Create a new <span class="caps">RDS</span> instance. Allocate the minimum amount of storage possible. Then, increase that storage by <span class="caps">5GB</span> (only works on Oracle and MySQL) until you hit how much you want. Yes, this is slow, yes, this is a <span class="caps">HUGE</span> pain in the ass. But, everytime you increase storage, you&#8217;re striping disks. More disks = better io and less seek time and in turn reducing <span class="caps">CPU</span> load and increasing responsiveness. Dirty little secret, lots of people do&nbsp;it.</p>
</blockquote>
<h2><span class="caps">AWS</span>&#8217; Xen&nbsp;Setup</h2>
<blockquote>
<p>Well, typically the hardware nodes (<span class="caps">HN</span>) runs a copy of Amazon Linux, which has several internal flavors. Obviously this is done to maintain image quality and keep reproducibility. Each <span class="caps">HN</span> is silo&#8217;d like you say. So, if you&#8217;re running m1.xl, you&#8217;ll be sharing with only other m1.xl&#8217;s. There are two flavors of <span class="caps">HN</span>&#8217;s, one for &#8220;on-demand&#8221; and one for &#8220;vpc&#8221; (hence the new <span class="caps">VPC</span> by default announcement to fix that disparity). On the old on-demand <span class="caps">HN</span>&#8217;s you have &#8220;slots&#8221;, each slot is assigned an internal <span class="caps">IP</span> address. Once your server is in a slot, it get&#8217;s that internal <span class="caps">IP</span> address and an <span class="caps">EIP</span> is <span class="caps">NAT</span>&#8217;d to that internal&nbsp;<span class="caps">IP</span>.</p>
</blockquote>
<h2>On-Demand vs.&nbsp;<span class="caps">VPC</span></h2>
<blockquote>
<p>The major difference between <span class="caps">VPC</span> and On-Demand <span class="caps">HN</span>&#8217;s is the fact that the On-Demand <span class="caps">HN</span>&#8217;s, like I said, have IPs assigned to the slots. Where the <span class="caps">VPC</span> <span class="caps">HN</span>&#8217;s do as well, but they&#8217;re not used. They get your subnet routed to them. They get <span class="caps">EC2</span> &#8220;slots&#8221; because it&#8217;s easier to maintain a single platform as much as possible and diverging as less as&nbsp;possible.</p>
</blockquote>
<h2><span class="caps">NAT</span>&nbsp;Servers</h2>
<blockquote>
<p>As far as <span class="caps">NAT</span> servers, hate them sons of bitches. Honestly, Amazon should have invested in real hardware. <span class="caps">NAT</span> instances aren&#8217;t actually &#8220;<span class="caps">NAT</span>&#8221; according to <span class="caps">RFC</span>, they&#8217;re actually <span class="caps">PAT</span> (Port Address Translation). They just translate all ports and forward them. However, because the <span class="caps">NAT</span> devices are actually x86 devices, you gotta use a ton of them to get the throughput of a single mid-grade router doing the same function due to a lack of <span class="caps">ASIC</span> chips. Stupid choice&nbsp;imo.</p>
<p>The <span class="caps">NAT</span> devices which are doing all this work are called &#8220;Blackfoots&#8221; unless you&#8217;ve spawned a specific &#8220;<span class="caps">NAT</span> Instance&#8221; in your <span class="caps">VPC</span>, which is an instance, obviously. The Blackfoots are shared <span class="caps">NAT</span> devices on fairly beefy hardware and do multiple 10Gb network ports worth of&nbsp;<span class="caps">PAT</span>.</p>
<p>If I were to re-architect the network layer, I would grab a handful of Nexus 7000&#8217;s for routing all my internal traffic, do 1:1 natting at the Nexus, then run some Nexus 5000&#8217;s to each row of racks and terminate each rack with a Nexus fabric extender. The network performance increase would most likely give people whiplash from their neck snapping&nbsp;back.</p>
</blockquote>
    <div class="post-comments">
        <h2 class="post-title">Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = 'ianalexandr';

            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
                </div>
            </div>
            
            <br/>
            <footer>
                <p id="footer">
                    designed in san francisco &mdash;
                    built with <a href="http://hyde.github.com/">hyde</a> &mdash;
                    licensed as <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">cc-by-nc-nd</a>
                </p>
            </footer>

        </div> <!-- /container -->

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/media/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>

        <script src="/media/js/vendor/bootstrap.min.js"></script>

        <script src="/media/js/plugins.js"></script>
        <script src="/media/js/main.js"></script>

                <!-- asynchronous google analytics: mathiasbynens.be/notes/async-analytics-snippet
       change the UA-XXXXX-X to be your site's ID -->
<script>
    var _gaq = [['_setAccount', 'UA-32310051-1'], ['_trackPageview']];
    (function(d, t) {
    var g = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
    g.async = true;
    g.src = ('https:' == location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g, s);
    })(document, 'script');

    function clickme(link) {
		return _gaq.push(['_trackEvent', 'Outgoing Links', 'Click', link]);
  	}
</script>
            </body>
</html>